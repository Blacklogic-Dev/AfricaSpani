<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AfricaSpani | Candidates</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="bg-gray-100 min-h-screen p-4">

  <!-- HEADER -->
  <div class="flex items-center justify-between mb-6">
    <a href="index.html" class="text-sky-600 font-semibold">
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </a>
    <h1 class="text-xl font-bold">Candidate Data Capture</h1>
  </div>

  <!-- FORM -->
  <div class="bg-white p-6 rounded-lg shadow-md mb-8">
    <h2 class="font-semibold mb-4">Add / Edit Candidate</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <input id="name" placeholder="Name & Surname" class="border p-2 rounded">
      <input id="email" placeholder="Email" class="border p-2 rounded">
      <input id="age" placeholder="Age" type="number" class="border p-2 rounded">
      <input id="job" placeholder="Job Title" class="border p-2 rounded">
      <input id="cell" placeholder="Cellphone Number" class="border p-2 rounded">
      <input id="address" placeholder="Address" class="border p-2 rounded">
      <input id="experience" placeholder="Experience (years)" class="border p-2 rounded">

      <select id="status" class="border p-2 rounded">
        <option value="">Status</option>
        <option>Qualified</option>
        <option>In Progress</option>
        <option>Rejected</option>
      </select>
    </div>

    <button onclick="saveCandidate()" class="mt-4 bg-sky-500 text-white px-4 py-2 rounded">
      <i class="fas fa-save"></i> Save Candidate
    </button>
  </div>

  <!-- TEMP GRID -->
  <div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="font-semibold mb-4">Temporary Candidate Grid</h2>

    <table class="w-full border">
      <thead class="bg-gray-200">
        <tr>
          <th class="p-2 text-left">Verification Code</th>
          <th class="text-left">Age</th>
          <th class="text-left">Job Title</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody id="grid"></tbody>
    </table>

    <button
      id="dilBtn"
      onclick="generateDIL()"
      disabled
      class="mt-4 bg-black text-white px-4 py-2 rounded disabled:opacity-40">
      Generate DIL Receipt
    </button>
  </div>

  <!-- RECEIPT -->
  <div id="receipt" class="hidden bg-white mt-8 p-6 shadow-lg">
    <h2 class="text-center font-bold mb-4">DIL RECEIPT</h2>
    <p id="receiptMeta" class="text-sm mb-4"></p>
    <div id="receiptBody" class="text-sm font-mono whitespace-pre-wrap"></div>
  </div>

<script>
let candidates = [];
let editIndex = null;

function generateVerificationCode(i) {
  return `2025/0011/1011/0${i + 1}`;
}

function confirmUser(action) {
  const u = prompt(`Confirm username to ${action}:`);
  return (u === "KX0011" || u === "KX1011");
}

function saveCandidate() {
  if (!confirmUser("save candidate")) return;

  const c = {
    name: name.value,
    email: email.value,
    age: age.value,
    job: job.value,
    cell: cell.value,
    address: address.value,
    experience: experience.value,
    status: status.value
  };

  if (editIndex !== null) {
    candidates[editIndex] = c;
    editIndex = null;
  } else {
    if (candidates.length >= 5) {
      alert("Maximum 5 candidates per DIL batch.");
      return;
    }
    candidates.push(c);
  }

  clearForm();
  renderGrid();
}

function renderGrid() {
  grid.innerHTML = "";

  candidates.forEach((c, i) => {
    grid.innerHTML += `
      <tr class="border-b">
        <td class="p-2 font-mono">${generateVerificationCode(i)}</td>
        <td>${c.age}</td>
        <td>${c.job}</td>
        <td class="text-center">
          <button onclick="editCandidate(${i})" class="text-blue-600 mr-2">
            <i class="fas fa-pen"></i>
          </button>
          <button onclick="deleteCandidate(${i})" class="text-red-600">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    `;
  });

  dilBtn.disabled = candidates.length !== 5;
}

function editCandidate(i) {
  if (!confirmUser("edit candidate")) return;

  const c = candidates[i];
  name.value = c.name;
  email.value = c.email;
  age.value = c.age;
  job.value = c.job;
  cell.value = c.cell;
  address.value = c.address;
  experience.value = c.experience;
  status.value = c.status;
  editIndex = i;
}

function deleteCandidate(i) {
  if (!confirmUser("delete candidate")) return;
  candidates.splice(i, 1);
  renderGrid();
}

function generateDIL() {
  if (!confirmUser("generate DIL receipt")) return;

  receipt.classList.remove("hidden");

  receiptMeta.innerText =
    `Date: ${new Date().toLocaleString()}
DIL No: 2026 / 101100 / 03`;

  receiptBody.innerHTML = "";

  candidates.forEach((c, i) => {
    receiptBody.innerHTML += `
Candidate ${i + 1}
Verification Code: ${generateVerificationCode(i)}
Name: ${c.name}
Age: ${c.age}
Email: ${c.email}
Job Title: ${c.job}
Experience: ${c.experience}
Cellphone: ${c.cell}
Status: ${c.status}
-----------------------------
`;
  });
}

function clearForm() {
  document.querySelectorAll("input, select").forEach(e => e.value = "");
}
</script>

</body>
</html>